<!DOCTYPE html><html lang="ja"><head>
    <meta charset="UTF-8">
    <title>æ°´æº¶æ¶²ãŸã‚“ã¦ã„ãƒ»ã˜ã£ãã‚Šå­¦ç¿’ç‰ˆ</title>
    <style>
        body { 
            font-family: 'Helvetica Neue', Arial, sans-serif; 
            text-align: center; 
            background-image: url('https://images.unsplash.com/photo-1532094349884-543bc11b234d?auto=format&fit=crop&q=80&w=2070');
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
            padding: 10px; color: #333; font-size: 24px; 
        }

        #game-container { 
            background: rgba(255, 255, 255, 0.95);
            max-width: 850px; margin: 0 auto; padding: 30px; 
            border-radius: 40px; box-shadow: 0 20px 50px rgba(0,0,0,0.5); 
            position: relative; min-height: 800px; 
        }
        
        .header-info { display: flex; justify-content: space-between; align-items: center; background: #ecf0f1; padding: 15px 30px; border-radius: 20px; margin-bottom: 20px; border: 2px solid #bdc3c7; }
        .timer { font-size: 36px; font-weight: bold; color: #e74c3c; }
        .score { font-size: 32px; color: #2980b9; }

        .quit-btn { background: #95a5a6; color: white; padding: 10px 20px; border-radius: 10px; font-size: 18px; cursor: pointer; border: none; }

        #char-area { display: flex; align-items: center; background: #e8f5e9; padding: 20px; border-radius: 20px; margin-bottom: 20px; border: 4px solid #a5d6a7; min-height: 120px; }
        #char-icon { font-size: 80px; margin-right: 20px; }
        #char-msg { font-size: 26px; text-align: left; font-weight: 900; color: #1b5e20; line-height: 1.4; }

        #visual-box { height: 300px; display: flex; flex-direction: column; align-items: center; justify-content: center; border: 4px dashed #bdc3c7; margin-bottom: 20px; border-radius: 25px; background: rgba(255, 255, 255, 0.8); position: relative; }
        #visual-result { font-size: 32px; font-weight: bold; margin-top: 10px; }
        
        /* æ­£è§£ãƒ»ç¬¬ã€‡å•ãƒ‰ã‚«ãƒ³ï¼æ¼”å‡º */
        #flash-message {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            font-size: 120px; font-weight: bold; text-shadow: 0 0 30px #fff;
            display: none; z-index: 150; white-space: nowrap; pointer-events: none;
        }
        .flash-correct { color: #ff4757; text-shadow: 0 0 30px #fff, 0 0 10px #ff4757; }
        .flash-next { color: #3498db; text-shadow: 0 0 30px #fff, 0 0 10px #3498db; font-size: 100px; }

        .litmus-pair { display: flex; gap: 50px; }
        .paper-set { display: flex; flex-direction: column; align-items: center; }
        .litmus-paper { width: 80px; height: 160px; border: 3px solid #555; border-radius: 4px; }
        .paper-label { font-size: 18px; margin-top: 8px; font-weight: bold; color: #666; }

        .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 25px; }
        button { padding: 20px; cursor: pointer; border-radius: 20px; border: none; font-size: 26px; font-weight: bold; transition: 0.2s; box-shadow: 0 6px 0 #d4ac0d; }
        .action-btn { background: #f1c40f; color: #2c3e50; }
        .action-btn:active { transform: translateY(6px); box-shadow: none; }
        
        .ans-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .ans-btn { background: #3498db; color: white; font-size: 26px; box-shadow: 0 6px 0 #21618c; }

        #overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(44, 62, 80, 0.98); color: white; display: flex; flex-direction: column; justify-content: center; align-items: center; border-radius: 40px; z-index: 100; padding: 20px; }
        .lv-btn { margin: 15px; width: 500px; padding: 30px; font-size: 32px; border-radius: 25px; color: white; font-weight: bold; cursor: pointer; border: none; }
        
        #certificate { 
            display: none; position: absolute; top: 5%; left: 5%; width: 90%; height: 90%; 
            background: #fdf5e6; color: #5d4037; border: 15px double #d4af37; border-radius: 10px;
            padding: 40px; box-sizing: border-box; flex-direction: column; align-items: center; z-index: 200;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
        }
    </style></head><body>

<audio id="sound-correct" src="https://actions.google.com/sounds/v1/cartoon/trumpet_ding.ogg"></audio>
<audio id="sound-wrong" src="https://actions.google.com/sounds/v1/cartoon/pop.ogg"></audio>

<div id="game-container">
    <div id="flash-message"></div>

    <div id="overlay">
        <h1 id="overlay-title" style="font-size: 60px; margin-bottom: 10px;">ğŸ” æ°´æº¶æ¶²ãŸã‚“ã¦ã„</h1>
        <p id="overlay-msg" style="font-size: 28px; margin-bottom: 30px;">ã˜ã£ãã‚Šè€ƒãˆã¦10å•ã›ã„ã‹ã„ã‚’ç›®æŒ‡ãã†ï¼</p>
        <div id="menu-btns">
            <button class="lv-btn" style="background:#2ecc71" onclick="startGame(1)">ã€åˆç´šã€‘300ç§’ã§10å•</button><br>
            <button class="lv-btn" style="background:#f39c12" onclick="startGame(2)">ã€ä¸­ç´šã€‘240ç§’ã§10å•</button><br>
            <button class="lv-btn" style="background:#e74c3c" onclick="startGame(3)">ã€ä¸Šç´šã€‘180ç§’ã§10å•</button>
        </div>
    </div>

    <div id="certificate">
        <h1 style="font-size: 50px; color: #d4af37; margin-bottom: 10px;">ğŸ† è¡¨å½°çŠ¶</h1>
        <p style="font-size: 40px; font-weight: bold;">æ°´æº¶æ¶²ãŸã‚“ã¦ã„ æ®¿</p>
        <div style="font-size: 28px; text-align: left; line-height: 1.8; margin: 30px 0;">
            ã‚ãªãŸã¯ã€Œæ°´æº¶æ¶²ãŸã‚“ã¦ã„ã€ã«ãŠã„ã¦ã€è‡ªåˆ†ã®åŠ›ã§ã˜ã£ãã‚Šã¨è€ƒãˆã€10å•ã®é›£å•ã‚’ã™ã¹ã¦è§£ãæ˜ã‹ã—ã¾ã—ãŸã€‚<br>
            ãã®åŠªåŠ›ã¨ ç´ æ™´ã‚‰ã—ã„è¦³å¯ŸåŠ›ã‚’ãŸãŸãˆ ã“ã“ã«è¡¨å½°ã—ã¾ã™ã€‚
        </div>
        <p style="font-size: 24px; align-self: flex-end; margin-top: 20px;">ç†ç§‘å®¤ã®å…ˆç”Ÿã‚ˆã‚Š ğŸ‘¨â€ğŸ«</p>
        <button class="lv-btn" style="background:#3498db; margin-top: 40px;" onclick="showHome()">ãƒ›ãƒ¼ãƒ ã«ã‚‚ã©ã‚‹</button>
    </div>

    <div class="header-info">
        <button class="quit-btn" onclick="showHome()">ğŸ  ã‚„ã‚ã‚‹</button>
        <div class="timer">â³ <span id="time-left">--</span></div>
        <div class="score">ã›ã„ã‹ã„: <span id="score-val">0</span> / 10</div>
    </div>
    
    <div id="char-area">
        <div id="char-icon">ğŸ‘¨â€ğŸ«</div>
        <div id="char-msg"></div>
    </div>

    <div id="visual-box">
        <div id="flask-icon" style="font-size: 100px;">ğŸ§ª</div>
        <div id="visual-result">æº–å‚™ä¸­...</div>
    </div>

    <div id="action-area" class="btn-grid"></div>

    <div style="font-weight:bold; margin-bottom:10px; font-size: 28px;">ã€æ­£ä½“ã¯ã©ã‚Œã‹ãªï¼Ÿã€‘</div>
    <div id="ans-area" class="ans-grid"></div>
</div>

<script>
const allLiquids = [
    { name: "é£Ÿå¡©æ°´", litmus: "ä¸­æ€§", strength: "ãªã—", residue: "ç™½", metal: "ãªã—", smell: "ãªã—", lv: 1 },
    { name: "å¡©é…¸", litmus: "é…¸æ€§", strength: "å¼·ã„", residue: "ãªã—", metal: "ã‚ã‚Š", smell: "ã‚ã‚Š", lv: 1 },
    { name: "ã‚¢ãƒ³ãƒ¢ãƒ‹ã‚¢æ°´", litmus: "ã‚¢ãƒ«ã‚«ãƒªæ€§", strength: "å¼·ã„", residue: "ãªã—", metal: "ãªã—", smell: "ã‚ã‚Š", lv: 1 },
    { name: "ç‚­é…¸æ°´", litmus: "é…¸æ€§", strength: "å¼±ã„", residue: "ãªã—", metal: "ãªã—", smell: "ãªã—", lv: 2 },
    { name: "é‡æ›¹æ°´", litmus: "ã‚¢ãƒ«ã‚«ãƒªæ€§", strength: "å¼±ã„", residue: "ç™½", metal: "ãªã—", smell: "ãªã—", lv: 2 },
    { name: "çŸ³ç°æ°´", litmus: "ã‚¢ãƒ«ã‚«ãƒªæ€§", strength: "å°‘ã—å¼·ã„", residue: "ç™½", metal: "ãªã—", smell: "ãªã—", lv: 3 },
    { name: "é…¢", litmus: "é…¸æ€§", strength: "å¼±ã„", residue: "ãªã—", metal: "ãªã—", smell: "ã‚ã‚Š", lv: 3 }
];

let target, score, timeLeft, timerId, currentLevel;

function showHome() { document.location.reload(); }

function startGame(level) {
    currentLevel = level;
    score = 0;
    if(level === 1) timeLeft = 300;
    else if(level === 2) timeLeft = 240;
    else timeLeft = 180;

    document.getElementById('overlay').style.display = 'none';
    
    const actArea = document.getElementById('action-area');
    actArea.innerHTML = `<button class="action-btn" onclick="conduct('litmus')">ãƒªãƒˆãƒã‚¹ç´™</button>`;
    if(level >= 2) actArea.innerHTML += `<button class="action-btn" onclick="conduct('evaporate')">ã˜ã‚‡ã†ã¯ã¤</button>`;
    if(level >= 3) {
        actArea.innerHTML += `<button class="action-btn" onclick="conduct('metal')">ã‚¢ãƒ«ãƒŸ</button>`;
        actArea.innerHTML += `<button class="action-btn" onclick="conduct('smell')">ã«ãŠã„</button>`;
    }
    actArea.style.gridTemplateColumns = (level === 1) ? "1fr" : "1fr 1fr";

    updateUI();
    
    const msg = document.getElementById('char-msg');
    msg.innerText = `ã˜ã£ãã‚Šæ™‚é–“ã‚’ã¨ã£ã¦ ${timeLeft}ç§’ã«ã—ãŸã‚ˆã€‚ã‚ã›ã‚‰ãšã«ã€å®Ÿé¨“ã®çµæœã‚’ã‚ˆãè¦‹ã¦10å•æ­£è§£ã‚’ç›®æŒ‡ãã†ã­ï¼`;
    
    setTimeout(() => {
        nextQuestion();
        if(timerId) clearInterval(timerId);
        timerId = setInterval(tick, 1000);
    }, 3000);
}

function tick() {
    timeLeft--;
    document.getElementById('time-left').innerText = timeLeft;
    if(timeLeft <= 0) endGame("ã˜ã‹ã‚“ãã‚Œï¼");
}

function nextQuestion() {
    const list = allLiquids.filter(l => l.lv <= currentLevel);
    target = list[Math.floor(Math.random() * list.length)];
    document.getElementById('visual-result').innerText = "å®Ÿé¨“ã—ã¦æ­£ä½“ã‚’ã‚ã¦ã‚ˆã†ï¼";
    
    const flash = document.getElementById('flash-message');
    flash.innerText = `ç¬¬ ${score + 1} å•`;
    flash.className = "flash-next";
    flash.style.display = "block";
    setTimeout(() => { flash.style.display = "none"; }, 1000);

    const msg = document.getElementById('char-msg');
    if (target.strength === "å¼·ã„") {
        msg.innerText = "ã“ã‚Œã¯ ã‹ãªã‚Šå¼·çƒˆï¼ˆãã‚‡ã†ã‚Œã¤ï¼‰ãªæ€§è³ªã®æ°´æº¶æ¶²ã ã­ã€‚å®Ÿé¨“ã®çµæœãŒã¯ã£ãã‚Šå‡ºã‚‹ã‚ˆã€‚";
    } else if (target.strength === "å°‘ã—å¼·ã„") {
        msg.innerText = "å°‘ã—å¼·ã‚ã®æ€§è³ªãŒã‚ã‚‹ã¿ãŸã„ã€‚ã©ã‚“ãªå¤‰åŒ–ãŒèµ·ãã‚‹ã‹ãªï¼Ÿ";
    } else if (target.strength === "å¼±ã„") {
        msg.innerText = "ãŠã ã‚„ã‹ãªã€å¼±ã„æ€§è³ªã®æ°´æº¶æ¶²ã ã‚ˆã€‚ã‚†ã£ãã‚Šèª¿ã¹ã¦ã¿ã¦ã­ã€‚";
    } else {
        msg.innerText = "ç‰¹åˆ¥ãªå¼·ã•ã¯ãªã„ã¿ãŸã„ã€‚ä¸­æ€§ã‹ãªï¼Ÿãƒªãƒˆãƒã‚¹ç´™ã§ç¢ºã‹ã‚ã‚ˆã†ã€‚";
    }

    const ansArea = document.getElementById('ans-area');
    ansArea.innerHTML = "";
    list.forEach(l => {
        ansArea.innerHTML += `<button class="ans-btn" onclick="check('${l.name}')">${l.name}</button>`;
    });
}

function conduct(type) {
    const res = document.getElementById('visual-result');
    if(type === 'litmus') {
        let redPaperColor = "#ffcdd2"; let bluePaperColor = "#bbdefb";
        if (target.litmus === 'é…¸æ€§') {
            bluePaperColor = (target.strength === "å¼·ã„") ? "#d32f2f" : "#ef9a9a";
        } else if (target.litmus === 'ã‚¢ãƒ«ã‚«ãƒªæ€§') {
            redPaperColor = (target.strength === "å¼·ã„") ? "#1976d2" : "#90caf9";
        }
        res.innerHTML = `<div class="litmus-pair">
            <div class="paper-set"><div class="litmus-paper" style="background:${redPaperColor};"></div><div class="paper-label">èµ¤ãƒªãƒˆãƒã‚¹ç´™</div></div>
            <div class="paper-set"><div class="litmus-paper" style="background:${bluePaperColor};"></div><div class="paper-label">é’ãƒªãƒˆãƒã‚¹ç´™</div></div>
        </div>`;
    } else if(type === 'evaporate') {
        res.innerHTML = `<span style="font-size:80px;">ğŸ”¥</span><br>${target.residue === 'ç™½' ? "ç™½ã„ç²‰ãŒæ®‹ã£ãŸï¼" : "ä½•ã‚‚æ®‹ã‚‰ãªã„"}`;
    } else if(type === 'metal') {
        res.innerHTML = `<span style="font-size:80px;">ğŸ«§</span><br>${target.metal === 'ã‚ã‚Š' ? "ã‚ã‚ã‚’å‡ºã—ã¦æº¶ã‘ãŸï¼" : "å¤‰åŒ–ãªã—"}`;
    } else if(type === 'smell') {
        res.innerHTML = `<span style="font-size:80px;">ğŸ‘ƒ</span><br>${target.smell === 'ã‚ã‚Š' ? "ãƒ„ãƒ³ã¨ã™ã‚‹ã«ãŠã„ï¼" : "ã«ãŠã„ã¯ãªã„"}`;
    }
}

function check(name) {
    const flash = document.getElementById('flash-message');
    if(name === target.name) {
        score++;
        updateUI();
        document.getElementById('sound-correct').play().catch(()=>{});
        
        flash.innerText = "æ­£è§£ï¼ï¼";
        flash.className = "flash-correct";
        flash.style.display = 'block';
        
        setTimeout(() => {
            flash.style.display = 'none';
            if(score >= 10) {
                winGame();
            } else {
                nextQuestion();
            }
        }, 1200);
    } else {
        timeLeft -= 5;
        document.getElementById('sound-wrong').play().catch(()=>{});
        document.getElementById('visual-result').innerHTML = "<span style='color:red;'>âŒ ã¡ãŒã†ã¿ãŸã„ã€‚ã‚‚ã†ä¸€åº¦å®Ÿé¨“ã—ã¦ã¿ã‚ˆã†ï¼ (-5ç§’)</span>";
    }
}

function updateUI() {
    document.getElementById('score-val').innerText = score;
}

function winGame() {
    clearInterval(timerId);
    document.getElementById('certificate').style.display = 'flex';
}

function endGame(title) {
    clearInterval(timerId);
    const overlay = document.getElementById('overlay');
    overlay.style.display = 'flex';
    document.getElementById('overlay-title').innerText = title;
    document.getElementById('overlay-msg').innerText = `æ­£è§£æ•°ï¼š ${score}å•ã€‚æ¬¡ã¯10å•ã‚’ç›®æŒ‡ãã†ï¼`;
    document.getElementById('menu-btns').innerHTML = `<button class="lv-btn" style="background:#3498db" onclick="showHome()">ã‚‚ã†ã„ã¡ã© æŒ‘æˆ¦ã™ã‚‹</button>`;
}
</script></body></html>